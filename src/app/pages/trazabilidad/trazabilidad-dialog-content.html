<div
  class="d-flex align-items-center justify-content-between m-b-8 p-x-20 p-t-16">
  <h3>{{action}} Lote</h3>
  <button
    mat-icon-button
    mat-dialog-close
    class="d-flex justify-content-center">
    <i-tabler name="x" class="icon-20 d-flex"></i-tabler>
  </button>
</div>

<!-- -------------------------------------------------------------- -->
<!-- Add Employee -->
<!-- -------------------------------------------------------------- -->

@if(action !== 'Delete') {
<mat-dialog-content>
  <form #userForm="ngForm">
    @if(action === 'Update') {
    <div class="d-flex align-items-center gap-16 m-b-16">
      <img class="rounded-circle" [src]="local_data.product_image" width="45" />
      <div>
        <h6 class="f-w-600 f-s-16 m-t-0">
          {{ local_data.product_name }}
        </h6>
        <span class="f-s-14">{{ local_data.variant_name }}</span>
      </div>
    </div>
    }
    <div class="row">
      
      <div class="col-lg-6">
        <mat-label class="f-s-14 f-w-600 m-b-8 d-block">Número de
          lote</mat-label>
        <mat-form-field appearance="outline" class="w-100">
          <input
            type="text"
            matInput
            required
            id="numero_lote"
            name="numero_lote"
            [(ngModel)]="local_data.lote_number"
            placeholder="Número" />
        </mat-form-field>
      </div>

      <div class="col-lg-6">
        <mat-label class="f-s-14 f-w-600 m-b-8 d-block">
          {{ action === 'Add' ? 'Stock inicial' : 'Stock actual' }}
        </mat-label>
        <mat-form-field appearance="outline" class="w-100">
          <input
            type="number"
            matInput
            required
            name="remaining"
            [(ngModel)]="local_data.remaining"
            [disabled]="action === 'Update'"
            placeholder="Introduce el stock" />
          <mat-hint *ngIf="action === 'Update'">
            Stock resultante: {{ stockResultante }}
          </mat-hint>
        </mat-form-field>
      </div>
      @if(action === 'Update') {
      <div class="col-lg-6">
        <mat-label class="f-s-14 f-w-600 m-b-8 d-block">
          Método de actualización
        </mat-label>
        <mat-radio-group
          [(ngModel)]="modoRelativo"
          (ngModelChange)="onModoChange($event)"
          name="modoRelativo"
          class="d-flex gap-3">
          <mat-radio-button [value]="false">Valor absoluto</mat-radio-button>
          <mat-radio-button [value]="true">Ajuste relativo</mat-radio-button>
        </mat-radio-group>
      </div>
      <div class="col-lg-6">
        <mat-label class="f-s-14 f-w-600 m-b-8 d-block">Nuevo Stock</mat-label>
        <mat-form-field appearance="outline" class="w-100">
          <input
            type="number"
            matInput
            [(ngModel)]="nuevoStock"
            name="nuevoStock"
            placeholder="{{ modoRelativo ? '± unidades' : 'Total final' }}" />
          <mat-hint>
            Stock resultante: {{ stockResultante }}
          </mat-hint>
        </mat-form-field>
      </div>
      }
      <div class="col-lg-6">
        <mat-label class="f-s-14 f-w-600 m-b-8 d-block">Fecha de
          caducidad</mat-label>
        <mat-form-field appearance="outline" class="w-100">
          <input
            matInput
            [matDatepicker]="picker"
            [formControl]="joiningDate"
            placeholder="Escoge una fecha" />
          <mat-datepicker-toggle matSuffix
            [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>
      </div>

      <div class="col-lg-12">
        <mat-label
          class="f-s-14 f-w-600 m-b-8 d-block">Observaciones</mat-label>
        <mat-form-field appearance="outline" class="w-100">
          <textarea
            type="text"
            matInput
            id="obs"
            name="obs"
            [(ngModel)]="local_data.observations"
            placeholder="Observaciones"></textarea>
        </mat-form-field>
      </div>
    </div>

    <button
      style="float: right;"
      mat-flat-button
      (click)="doAction()"
      class="m-l-8"
      mat-flat-button
      [disabled]="!userForm.valid">
      {{action}}
    </button>
    <button
      style="float: right;"
      mat-flat-button
      class="bg-error text-white"
      (click)="closeDialog()">
      Cancel
    </button>

  </form>
</mat-dialog-content>
}
<!-- -------------------------------------------------------------- -->
<!-- Delete Employee info -->
<!-- -------------------------------------------------------------- -->

@else {
<div class="p-x-24 m-y-8">
  <p class="f-s-14">
    Sure to delete <span class="f-w-600">{{local_data.lote_number}}</span> ?
  </p>
</div>
<div mat-dialog-actions class="p-x-24 p-b-24">
  <button
    mat-flat-button
    (click)="closeDialog()"
    class="m-l-8 bg-error text-white">
    Cancel
  </button>
  <button (click)="doAction()" mat-flat-button>{{action}}</button>

</div>
}
